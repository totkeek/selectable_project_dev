設問が1以上表示される画面がn(0 < n)ページあり。1ページ目からnページ目にかけて1ページづつ遷移する。戻る場合も同様。
nページ内の設問に回答したのち、つぎの画面へ遷移すると結果画面が表示される

要件として、設問の回答状況によって、設問が表示非表示、別の設問が表示される制約がある。また、設問の回答状況によって設問内の選択肢の種類、順序、グルーピングが変化する

階層としては、画面→設問→選択肢グループ→選択肢ですね。
                    ↓→グルーピング

イメージとしては、
設問に回答
↓
設問の回答と過去に回答した他の回答状況を合わせて、次の設問を決定
↓
設問
↓
設問の回答と過去に回答した他の回答状況を合わせて、設問に表示する選択肢グループを決定
↓
設問の回答と過去に回答した他の回答状況を合わせて、設問に表示する選択肢をどのようにグルーピングとフィルタリングするかを決定
↓
選択肢をグルーピングとフィルタリングを行いながらソートする
↓
設問と選択肢を表示

選択肢の表示順についてのイメージはこんなかんじ

選択肢グループ内には、選択肢があり表示順がきまっている。
1つの設問に選択肢グループが2つ以上ある場合、グループ単位で表示順がある。(回答状況によって、設問XではグループAとグループBを1,2の順で並べますみたいな)なので、グループ単位を管理するテーブルや設問そのものには表示順はない
なので、グループ単位の表示順→グループ内の選択肢の表示順です。このソートが終わったあとに、ソート順をくずさないようにグルーピングを行う。

グルーピングについては、そもそも選択肢が親子構造なのを利用します。例えば水栓は、メーカ→図番→品番 水栓管理番号→図番→品番 の親子構造があります。メーカ、水栓管理番号、図番、品番のうち、基本的に選択肢として表示するのは品番のみですが、他の要素も選択肢として登録します。

